@{
    ViewBag.Title = "AccountOverVIew";
}

<h2>账户总览</h2>

<div class="container-fluid">
    <div class="row">
        <div class="col-md-1"></div>
        <div class="col-md-2">
            <h3><span class="label label-info">用户名：</span><span class="label label-info" id="userName"></span></h3>
        </div>
        <div class="col-lg-2">
            <h3><span class="label label-info">授权股票金额：</span><span class="label label-info" id="account"></span></h3>
        </div>
        <div class="col-lg-2">
            <h3><span class="label label-info">股票账户余额：</span><span class="label label-info" id="balance"></span></h3>
        </div>
        <div class="col-lg-2">
            <h3><span class="label label-info">冻结金额：</span><span class="label label-info" id="frezon"></span></h3>
        </div>
        <div class="col-lg-2">
            <h3><span class="label label-info">股票市值：</span><span class="label label-info" id="value"></span></h3>
        </div>
        <div class="col-md-1"></div>
    </div>
    <div class="col-md-12">
        <div id="positionList" class="col-md-12" style="margin-top:20px">
            <ul class="list-group" style="display:inline-block"></ul>
        </div>
    </div>
    <div class="col-md-12">
        <div id="entrustList" class="col-md-12" style="margin-top:20px">
            <ul class="list-group" style="display:inline-block"></ul>
        </div>
    </div>

</div>

@section scripts{
    <!--Script references. -->
    <!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery.signalR-2.2.0.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <!--SignalR script to update the chat page and send messages.-->
    <script>
        $(function () {
            var chat = $.connection.accountHub;
           
            //更新账户信息
            chat.client.updateTradeList = function (jsonString) {
                var _trade = eval('(' + jsonString + ')');

                var _orderRef = _trade.OrderRef;
                var _tradeID = _trade.TradeID;
                var _code = _trade.Code;
                var _direction = _trade.Direction;
                var _combOff = _trade.CombOff;
                var _price = _trade.Price;
                var _volume = _trade.Volume;
                var _orderSysId = _trade.OrderSysID;

                var newRow = "<tr><td>" + _orderRef + "</td><td>" + _tradeID + "</td><td>" + _code + "</td><td>" + _direction + "</td><td>" + _combOff + "</td><td>" + _price + "</td><td>" + _volume + "</td><td>" + _orderSysId + "</td></tr>";
                $('#tm_tb_tradeRecord').append(newRow);
            };

            $.connection.hub.start().done(function () {
                chat.state.USERNAME = localStorage["USERNAME"];
                chat.server.linkin();
            });
        });
    </script>
}